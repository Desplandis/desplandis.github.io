---
import BlogLayout from '@layouts/BlogLayout.astro';
import { getCollection } from 'astro:content';
import { sortByDateDesc, filterDrafts } from '@utils/dates';

// Get all published posts
const allPosts = await getCollection('blog');
const publishedPosts = sortByDateDesc(filterDrafts(allPosts));

// Get all unique tags
const allTags = [
  ...new Set(publishedPosts.flatMap((post) => post.data.tags)),
].sort();
---

<BlogLayout
  title="Blog"
  description="Framework updates, governance communication, and technical insights from the iTowns community."
  posts={publishedPosts}
  allTags={allTags}
/>
