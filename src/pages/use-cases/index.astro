---
import PageLayout from '@layouts/PageLayout.astro';
import Card from '@components/ui/Card.astro';
import Badge from '@components/ui/Badge.astro';
import { getCollection } from 'astro:content';

const useCases = await getCollection('use-cases');
const sortedUseCases = useCases
  .filter((uc) => !uc.data.draft)
  .sort((a, b) => (a.data.order || 999) - (b.data.order || 999));

const industryLabels: Record<string, string> = {
  government: 'Government',
  research: 'Research',
  'urban-planning': 'Urban Planning',
  defense: 'Defense',
  environment: 'Environment',
  transportation: 'Transportation',
  utilities: 'Utilities',
  'real-estate': 'Real Estate',
  'cultural-heritage': 'Cultural Heritage',
  general: 'General',
};

// Featured use cases for hero section
const featuredUseCases = sortedUseCases.filter((uc) => uc.data.featured);
---

<PageLayout
  title="Use Cases"
  description="Discover how iTowns can be applied across industries for 3D geospatial visualization, analysis, and decision-making."
>
  <div class="use-cases-page">
    <div class="container">
      <!-- Header -->
      <header class="page-header">
        <h1>Use Cases</h1>
        <p class="page-description">
          Explore application scenarios where iTowns excels. From urban planning
          to environmental monitoring, see how organizations leverage 3D
          geospatial visualization.
        </p>
      </header>

      <!-- Featured Use Cases -->
      {
        featuredUseCases.length > 0 && (
          <section class="featured-section">
            <h2>Featured Applications</h2>
            <div class="featured-grid">
              {featuredUseCases.map((uc) => (
                <a href={`/use-cases/${uc.slug}`} class="featured-card">
                  <div class="featured-content">
                    <div class="featured-meta">
                      <Badge audience={uc.data.audience} />
                      <span class={`complexity complexity-${uc.data.complexity}`}>
                        {uc.data.complexity}
                      </span>
                    </div>
                    <h3>{uc.data.title}</h3>
                    <p>{uc.data.summary}</p>
                    {uc.data.typicalDataSources && (
                      <div class="data-sources">
                        <span class="label">Data sources:</span>
                        {uc.data.typicalDataSources.slice(0, 3).join(', ')}
                      </div>
                    )}
                  </div>
                </a>
              ))}
            </div>
          </section>
        )
      }

      <!-- All Use Cases -->
      <section class="all-use-cases">
        <h2>All Use Cases</h2>
        <div class="use-cases-grid">
          {
            sortedUseCases.map((uc) => (
              <Card href={`/use-cases/${uc.slug}`}>
                <div class="card-meta">
                  <span class="industry-tag">
                    {industryLabels[uc.data.industry] || uc.data.industry}
                  </span>
                  <span class={`complexity complexity-${uc.data.complexity}`}>
                    {uc.data.complexity}
                  </span>
                </div>
                <h3>{uc.data.title}</h3>
                <p class="summary">{uc.data.summary}</p>
                {uc.data.problem && (
                  <p class="problem">
                    <strong>Problem:</strong> {uc.data.problem}
                  </p>
                )}
              </Card>
            ))
          }
        </div>
      </section>

      <!-- CTA -->
      <section class="cta-section">
        <h2>Don't See Your Use Case?</h2>
        <p>
          iTowns is highly extensible. If you have a specific application in
          mind, check out our documentation or join the community to discuss
          your requirements.
        </p>
        <div class="cta-buttons">
          <a href="/docs" class="btn btn-primary">View Documentation</a>
          <a href="/community" class="btn btn-outline">Join Community</a>
        </div>
      </section>
    </div>
  </div>
</PageLayout>

<style>
  .use-cases-page {
    padding: var(--space-8) 0;
  }

  .page-header {
    text-align: center;
    max-width: 800px;
    margin: 0 auto var(--space-9);
  }

  .page-description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
  }

  /* Featured Section */
  .featured-section {
    margin-bottom: var(--space-9);
  }

  .featured-section h2 {
    margin-bottom: var(--space-5);
  }

  .featured-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: var(--space-5);
  }

  .featured-card {
    display: block;
    padding: var(--space-6);
    background: linear-gradient(
      135deg,
      var(--color-bg-secondary) 0%,
      var(--color-bg-primary) 100%
    );
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    text-decoration: none;
    transition: all var(--transition-fast);
  }

  .featured-card:hover {
    border-color: var(--color-accent-primary);
    box-shadow: var(--shadow-md);
    text-decoration: none;
  }

  .featured-meta {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
  }

  .featured-content h3 {
    font-size: var(--text-2xl);
    margin-bottom: var(--space-3);
    color: var(--color-text-primary);
  }

  .featured-content p {
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-4);
  }

  .data-sources {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
  }

  .data-sources .label {
    font-weight: 500;
  }

  /* Complexity Badge */
  .complexity {
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-weight: 500;
    text-transform: capitalize;
  }

  .complexity-beginner {
    background-color: rgba(22, 163, 74, 0.15);
    color: var(--color-success);
  }

  .complexity-intermediate {
    background-color: rgba(234, 179, 8, 0.15);
    color: #ca8a04;
  }

  .complexity-advanced {
    background-color: var(--color-accent-light);
    color: var(--color-accent-primary);
  }

  /* All Use Cases */
  .all-use-cases {
    margin-bottom: var(--space-9);
  }

  .all-use-cases h2 {
    margin-bottom: var(--space-5);
  }

  .use-cases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: var(--space-5);
  }

  .card-meta {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
  }

  .industry-tag {
    padding: var(--space-1) var(--space-2);
    background-color: var(--color-bg-secondary);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-weight: 500;
    color: var(--color-text-secondary);
  }

  .use-cases-grid h3 {
    font-size: var(--text-xl);
    margin-bottom: var(--space-3);
  }

  .summary {
    color: var(--color-text-secondary);
    margin-bottom: var(--space-3);
    line-height: var(--leading-relaxed);
  }

  .problem {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
  }

  /* CTA Section */
  .cta-section {
    text-align: center;
    padding: var(--space-8);
    background-color: var(--color-bg-secondary);
    border-radius: var(--radius-lg);
  }

  .cta-section h2 {
    margin-bottom: var(--space-4);
  }

  .cta-section p {
    color: var(--color-text-secondary);
    max-width: 600px;
    margin: 0 auto var(--space-6);
  }

  .cta-buttons {
    display: flex;
    gap: var(--space-4);
    justify-content: center;
  }

  .btn {
    padding: var(--space-3) var(--space-5);
    border-radius: var(--radius-md);
    font-weight: 500;
    text-decoration: none;
    transition: all var(--transition-fast);
  }

  .btn-primary {
    background-color: var(--color-accent-primary);
    color: white;
  }

  .btn-primary:hover {
    background-color: var(--color-accent-secondary);
  }

  .btn-outline {
    border: 1px solid var(--color-border);
    color: var(--color-text-primary);
  }

  .btn-outline:hover {
    border-color: var(--color-accent-primary);
    color: var(--color-accent-primary);
  }

  @media (max-width: 768px) {
    .featured-grid,
    .use-cases-grid {
      grid-template-columns: 1fr;
    }

    .cta-buttons {
      flex-direction: column;
      align-items: center;
    }
  }
</style>

